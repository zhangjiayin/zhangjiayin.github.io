---
layout: post
title: vim 使用技巧
date: 2008-08-19 18:14:00.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  dsq_thread_id: '4543641057'
author: 
permalink: "/2008/08/vim-%e4%bd%bf%e7%94%a8%e6%8a%80%e5%b7%a7.html"
---
```
url: http://blog.csdn.net/camry_camry/archive/2004/09/23/114188.aspx
作者: camry.wu@gmail.com

我是 vim 粉丝, 用了许久, 有一些自己的感受, 又到处挖到一些别人的技巧. 感觉对 vim
粉丝比较有用, 就把它记在这儿. 希望借此文套出大家自己的巧活, 就正应了抛砖引玉的古
话了.

先稍为介绍一下 vim. vi 是 unix/linux 下极为普遍的一种文本编辑器, 大部分机器上都
有. vi 有各种变种, 在不同的机器上常用不同的变种软件. 其中 vim 比较好用也用得比较
广泛. vim 是 Vi IMproved 的缩写, 表示更好的 vi. 我个人觉得它是非常好的编辑器(为
了避免 Emacs 粉丝挑眼, 就不说最好了). 没用过的也建议试试看, 当然 vim 对编写文本
文件很方便好用, 比如编写程序, html文档等等, 却不能用来编写 word 文档.

关于 vim 的安装, 基本使用方法等网络上能搜出许多, 就不在这里罗嗦了, 要是对 vim 有
兴趣, 那就看看这里(中文文档):[http://vcd.gro.clinux.org/](http://vcd.gro.clinux.org/)

本文就说些其中比较有用, 比较常用的命令, 若能熟练运用这些命令, 那么会发现编辑文件
很舒服.

说明:
以下的例子中 xxx 表示在命令模式下输入 xxx 并回车
以下的例子中 :xxx 表示在扩展模式下输入 xxx 并回车
小括号中的命令表示相关命令.
在编辑模式或可视模式下输入的命令会另外注明.

1. 查找

/xxx(?xxx) 表示在整篇文档中搜索匹配xxx的字符串, / 表示向下查找, ? 表示
向上查找.其中xxx可以是正规表达式,关于正规式就不多说了.
一般来说是区分大小写的, 要想不区分大小写, 那得先输入
:set ignorecase
查找到以后, 再输入 n 查找下一个匹配处, 输入 N 反方向查找.

*(#) 当光标停留在某个单词上时, 输入这条命令表示查找与该单词匹配的
下(上)一个单词. 同样, 再输入 n 查找下一个匹配处, 输入 N 反方
向查找.

g*(g#) 此命令与上条命令相似, 只不过它不完全匹配光标所在处的单词, 而
是匹配包含该单词的所有字符串.

gd 本命令查找与光标所在单词相匹配的单词, 并将光标停留在文档的非
注释段中第一次出现这个单词的地方.

% 本命令查找与光标所在处相匹配的反括号, 包括 () [] {}

f(F)x 本命令表示在光标所在行进行查找, 查找光标右(左)方第一个x字符.
找到后:
输入 ; 表示继续往下找
输入 , 表示反方向查找

2. 快速移动光标
在 vi 中, 移动光标和编辑是两件事, 正因为区分开来, 所以可以很方便的进行光标定
位和编辑. 因此能更快一点移动光标是很有用的.

w(e) 移动光标到下一个单词.
b 移动光标到上一个单词.

0 移动光标到本行最开头.
^ 移动光标到本行最开头的字符处.
$ 移动光标到本行结尾处.

H 移动光标到屏幕的首行.
M 移动光标到屏幕的中间一行.
L 移动光标到屏幕的尾行.
gg 移动光标到文档首行.
G 移动光标到文档尾行.
c-f (即 ctrl 键与 f 键一同按下) 本命令即 page down.
c-b (即 ctrl 键与 b 键一同按下, 后同) 本命令即 page up.

'' 此命令相当有用, 它移动光标到上一个标记处, 比如用 gd, * 等查
找到某个单词后, 再输入此命令则回到上次停留的位置.

'. 此命令相当好使, 它移动光标到上一次的修改行.

`. 此命令相当强大, 它移动光标到上一次的修改点.

3. 拷贝, 删除与粘贴
在 vi 中 y 表示拷贝, d 表示删除, p 表示粘贴. 其中拷贝与删除是与光标移动命令
结合的, 看几个例子就能够明白了.

yw 表示拷贝从当前光标到光标所在单词结尾的内容.
dw 表示删除从当前光标到光标所在单词结尾的内容.
y0 表示拷贝从当前光标到光标所在行首的内容.
d0 表示删除从当前光标到光标所在行首的内容.
y$ 表示拷贝从当前光标到光标所在行尾的内容.
d$ 表示删除从当前光标到光标所在行尾的内容.
yfa 表示拷贝从当前光标到光标后面的第一个a字符之间的内容.
dfa 表示删除从当前光标到光标后面的第一个a字符之间的内容.

特殊地:
yy 表示拷贝光标所在行.
dd 表示删除光标所在行.
D 表示删除从当前光标到光标所在行尾的内容.

关于拷贝, 删除和粘贴的复杂用法与寄存器有关, 可以自行查询.

4. 数字与命令
在 vi 中数字与命令结合往往表示重复进行此命令, 若在扩展模式的开头出现则表示行
号定位. 如:

5fx 表示查找光标后第 5 个 x 字符.

5w(e) 移动光标到下五个单词.

5yy 表示拷贝光标以下 5 行.
5dd 表示删除光标以下 5 行.

y2fa 表示拷贝从当前光标到光标后面的第二个a字符之间的内容.

:12,24y 表示拷贝第12行到第24行之间的内容.
:12,y 表示拷贝第12行到光标所在行之间的内容.
:,24y 表示拷贝光标所在行到第24行之间的内容. 删除类似.

5. 快速输入字符
在 vi 中, 不要求你输入每一个字符, 可以有很多种方法快速输入一些字符.
使用 linux/unix 的同学一定有一个经验, 在命令行下输入命令时敲入头几个字符再按
TAB 系统就会自动将剩下的字符补齐, 假如有多个匹配则会打印出来. 这就是著名的命令
补齐(其实windows中也有文件名补齐功能). vi 中有许多的字符串补齐命令, 非常方便.

c-p(c-n) 在编辑模式中, 输入几个字符后再输入此命令则 vi 开始向上(下)搜
索开头与其匹配的单词并补齐, 不断输入此命令则循环查找. 此命令
会在所有在这个 vim 程序中打开的文件中进行匹配.

c-x-l 在编辑模式中, 此命令快速补齐整行内容, 但是仅在本窗口中出现的
文档中进行匹配.

c-x-f 在编辑模式中, 这个命令表示补齐文件名. 如输入:
/usr/local/tom 后再输入此命令则它会自动匹配出:
/usr/local/tomcat/

abbr 即缩写. 这是一个宏操作, 可以在编辑模式中用一个缩写代替另一个
字符串. 比如编写java文件的常常输入 System.out.println, 这很
是麻烦, 所以应该用缩写来减少敲字. 可以这么做:
:abbr sprt System.out.println
以后在输入sprt后再输入其他非字母符号, 它就会自动扩展为System.
out.println

6. 替换
替换是 vi 的强项, 因为可以用正规表达式来匹配字符串.以下提供几个例子.

:s/aa/bb/g 将光标所在行出现的所有包含 aa 的字符串中的 aa 替换为 bb
:s/\<aa>/bb/g 将光标所在行出现的所有 aa 替换为 bb, 仅替换 aa 这个单词<br> :%s/aa/bb/g 将文档中出现的所有包含 aa 的字符串中的 aa 替换为 bb<br> :12,23s/aa/bb/g 将从12行到23行中出现的所有包含 aa 的字符串中的 aa 替换为 bb<br> :12,23s/^/#/ 将从12行到23行的行首加入 # 字符<br> :%s= *$== 将所有行尾多余的空格删除<br> :g/^\s*$/d 将所有不包含字符(空格也不包含)的空行删除.<br><br>7. 多文件编辑<br> 在一个 vim 程序中打开很多文件进行编辑是挺方便的.<br><br> :sp(:vsp) 文件名 vim 将分割出一个横(纵)向窗口, 并在该窗口中打开新文件.<br> 从 vim6.0 开始, 文件名可以是一个目录的名称, 这样, vim 会<br> 把该目录打开并显示文件列表, 在文件名上按回车则在本窗口打<br> 开该文件, 若输入 O 则在新窗口中打开该文件, 输入 ? 可以看<br> 到帮助信息.<br><br> :e 文件名 vim 将在原窗口中打开新的文件, 若旧文件编辑过, 会要求保存.<br><br> c-w-w vim 分割了好几个窗口怎么办? 输入此命令可以将光标循环定位<br> 到各个窗口之中.<br><br> :ls 此命令查看本 vim 程序已经打开了多少个文件, 在屏幕的最下方<br> 会显示出如下数据:<br> 1 %a "usevim.html" 行 162<br> 2 # "xxxxxx.html" 行 0<br><br> 其中:<br> 1 表示打开的文件序号, 这个序号很有用处.<br> %a 表示文件代号, % 表示当前编辑的文件,<br> # 表示上次编辑的文件<br> "usevim.html" 表示文件名.<br> 行 162 表示光标位置.<br><br> :b 序号(代号) 此命令将指定序号(代号)的文件在本窗口打开, 其中的序号(代号)<br> 就是用 :ls 命令看到的.<br><br> :set diff 此命令用于比较两个文件, 可以用<br> :vsp filename<br> 命令打开另一个文件, 然后在每个文件窗口中输入此命令,就能看<br> 到效果了.<br><br>8. 宏替换<br> vi 不仅可以用 abbr 来替换文字, 也可以进行命令的宏定义. 有些命令输起来很费劲,<br>因此我把它们定义到 <f1>-<f12> 上, 这样就很方便了.这些配置可以预先写到 ~/.vimrc<br>(windows 下为 $VIM/_vimrc) 中, 写进去的时候不用写前面的冒号.<br><br> :nmap <f2> :nohls<cr> 取消被搜索字串的高亮<br> :nmap <f9> <c-w>w 命令模式下转移光标到不同窗口<br> :imap <f9> <esc><f9> 输入模式下运行<f9><br> :nmap <f12> :%s= *$==<cr> 删除所有行尾多余的空格.<br> :imap <f12> <esc><f12> 同上<br><br> :java 中: (注, 这里为什么说 java 中, 因为以下定义对其他文件格式不起作用, 下文<br> 会说到如何实现这一点)<br> :nmap <f3> :comp javac<cr>:mak -d . %<cr><br> 此命令用 javac 编译 java 文件, 它会自动将光标定位到出错点. 不过这需要定<br> 义一个 javac.vim 文件在 $VIM/compiler 下, 在 javac.vim 里面只有两行字:<br> setlocal makeprg=javac<br> setlocal errorformat=%A%f:%l:\ %m,%-Z%p^,%-C%.%#<br><br> :nmap <f4> :comp ant<cr>:mak<cr><br> 此命令用 ant 编译 java 文件, 它会自动将光标定位到出错点. 一般来说, 安装<br> vim 后已经有了compiler/ant.vim文件, 因此这个命令可以直接使用. 但是需要<br> 在当前目录下有 build.xml 文件, 当然还必须安装 ant 才行.<br><br> :nmap <f5> :cl<cr> 此命令用于查看所有的编译错误.<br> :imap <f5> <esc><f5><br><br> :nmap <f6> :cc<cr> 此命令用于查看当前的编译错误.<br> :imap <f6> <esc><f6><br><br> :nmap <f7> :cn<cr> 此命令用于跳到下一个出错位置.<br> :imap <f7> <esc><f7><br><br> :nmap <f8> :cp<cr> 此命令用于跳到上一个出错位置.<br> :imap <f8> <esc><f8><br><br> :nmap <f11> :JavaBrowser<cr><br> 此命令用于在窗口左部分割出一个新窗口, 里面的内容是 java 的资源树, 包括<br> 本文件中出现的类, 类的成员变量及成员方法, 就好像 JCreator 表现的那样.<br> 在这个窗口中输入 ? 会看到帮助. 嘿嘿, 很好用, 不过需要 ctags 支持.<br> :imap <f11> <esc><f11><br><br>9. TAB<br> TAB 就是制表符, 单独拿出来做一节是因为这个东西确实很有用.<br><br> &lt;&lt; 输入此命令则光标所在行向左移动一个 tab.<br> &gt;&gt; 输入此命令则光标所在行向右移动一个 tab.<br> 5&gt;&gt; 输入此命令则光标后 5 行向右移动一个 tab.<br> :12,24&gt; 此命令将12行到14行的数据都向右移动一个 tab.<br> :12,24&gt;&gt; 此命令将12行到14行的数据都向右移动两个 tab.<br><br> 那么如何定义 tab 的大小呢? 有人愿意使用 8 个空格位, 有人用4个, 有的用2个.<br> 有的人希望 tab 完全用空格代替, 也有的人希望 tab 就是 tab. 没关系, vim 能<br> 帮助你.以下的设置一般也都先写入配置文件中, 免得老敲.<br><br> :set shiftwidth=4 设置自动缩进 4 个空格, 当然要设自动缩进先.<br> :set sts=4 即设置 softtabstop 为 4. 输入 tab 后就跳了 4 格.<br> :set tabstop=4 实际的 tab 即为 4 个空格, 而不是缺省的 8 个.<br> :set expandtab 在输入 tab 后, vim 用恰当的空格来填充这个 tab.<br><br>10. autocmd<br> 这个命令十分的强大, 可以用这个命令实现对不同的文件格式应用不同的配置; 可以<br>在新建文件时自动添加上版权声明等等. 这些命令一般定义在 ~/.vimrc 这样的配置文件<br>里面. 由于他很强大, 所以我不能给出很具体的说明, 只能举几个例子, 详细的请看帮助.<br><br> :autocmd! 删除所有之前的自动命令.<br> autocmd FileType java source ~/.vim/files/java.vim<br> autocmd FileType java source ~/.vim/files/jcommenter.vim<br> 以上两条命令让我在打开 java 文件时才应用后面提到的两个配置文件.<br> autocmd BufNewFile *.java 0r ~/.vim/files/skeletons/java.skel<br> 以上这条命令让我在新建 java 文件时自动加入 java.skel 文件的内容.<br> autocmd BufNewFile *.java normal gnp<br> 以上这条命令让我在新建 java 文件时自动运行 gnp 命令, 这个命令进行一些特殊化<br> 处理, 比如将新 java 文件中的 __date__ 替换成今天的日期什么的.<br><br>11. 常用脚本<br> 在 vim.sf.net 你可以发现很多脚本(script), 这些脚本常常有让你意想不到的作用.<br>我常用的有:<br><br> jcommenter.vim 自动加入 javadoc 风格的注释.<br> JBrowser.vim 类资源浏览. C, C++ 等可以用 Tlist<br><br> 还有许多有用的, 比如 checkstyle.vim 可以检验你的编程风格, jad.vim 可以直接<br> 反编译 .class 文件等等.<br><br>12. 常用配置<br> 在~/.vimrc 配置文件中你常常需要一些个性化配置. 比如上面写的一些宏定义, 一些<br>autocmd 定义等等. 比如:<br><br> set suffixes=.bak,~,.o,.h,.info,.swp,.aux,.bbl,.blg,.dvi,.lof,.log,.lot,.ps,.toc<br> 这样在vim中打开文件时, 按 tab 键补齐文件名时它会忽略上述文件.<br><br> set nu 显示行号<br> set ai 设置自动缩进<br> map Y y$ 让 Y 和 D 一样, 要不然 Y 的本意和 yy 一样.<br><br>13. 其他<br> 还有许多有意思的命令, 记录在这里免得忘记.<br><br> . 重复上次编辑命令.<br> :g/^/exec "s/^/".strpart(line(".")." ", 0, 4) 在行首插入行号<br> :runtime! syntax/2html.vim 转换 txt 成 html, 会按照你的<br> 颜色配置来转</f11></esc></f11></cr></f11></f8></esc></f8></cr></f8></f7></esc></f7></cr></f7></f6></esc></f6></cr></f6></f5></esc></f5></cr></f5></cr></cr></f4></cr></cr></f3></f12></esc></f12></cr></f12></f9></f9></esc></f9></c-w></f9></cr></f2></f12></f1></aa>
```

]]\>

